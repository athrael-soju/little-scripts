volumes:
  hf-cache: {}

services:
  deepseek-ocr:
    build: ./
    container_name: deepseek-ocr
    env_file:
      - .env
    environment:
      MODEL_NAME: ${MODEL_NAME:-deepseek-ai/DeepSeek-OCR}
      HUGGINGFACE_HUB_CACHE: /data/hf-cache
      HF_HOME: /data/hf-cache
      API_HOST: ${API_HOST:-0.0.0.0}
      API_PORT: ${API_PORT:-8200}
      MAX_UPLOAD_SIZE_MB: ${MAX_UPLOAD_SIZE_MB:-100}
    volumes:
      - hf-cache:/data/hf-cache
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [ gpu ]
    shm_size: "4g"
    ports:
      - "${API_PORT:-8200}:${API_PORT:-8200}"
    networks:
      - ocr-network

networks:
  ocr-network:
    driver: bridge
